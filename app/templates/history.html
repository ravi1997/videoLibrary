{% extends "layout.html" %}
{% block title %}History · RPC Surgical Video Library{% endblock %}

{% block content %}
<section class="mb-6 text-center sm:text-left">
    <h1 class="text-2xl md:text-3xl font-extrabold text-[color:var(--text)]">Watch History</h1>
    <p class="muted mt-1">Videos you’ve watched or started. Resume where you left off.</p>
</section>

<!-- Toolbar -->
<section class="mb-6">
    <div class="glass p-3 md:p-4 rounded-xl flex flex-col gap-4">

        <!-- Row 1: Sort + View + Actions -->
        <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div class="flex items-center gap-2">
                <button data-sort="recent"
                    class="sort-btn px-3 py-2 rounded-lg border border-[color:var(--border)] hover:bg-[color:var(--brand-50)]">🕒
                    Most Recent</button>
                <button data-sort="alpha"
                    class="sort-btn px-3 py-2 rounded-lg border border-[color:var(--border)] hover:bg-[color:var(--brand-50)]">🔤
                    A–Z</button>
                <button data-sort="progress"
                    class="sort-btn px-3 py-2 rounded-lg border border-[color:var(--border)] hover:bg-[color:var(--brand-50)]">📈
                    Highest Progress</button>
            </div>

            <div class="flex items-center gap-2">
                <button id="viewToggle"
                    class="btn-ghost px-3 py-2 rounded-lg border border-[color:var(--border)]">Toggle Grid/List</button>
                <button id="clearAll"
                    class="px-3 py-2 rounded-lg border border-[color:var(--danger)] text-[color:var(--danger)] hover:bg-[color:var(--brand-50)]">🧹
                    Clear All</button>
            </div>
        </div>

        <!-- Row 2: Stats -->
        <div class="flex flex-wrap items-center gap-4">
            <span class="muted">Items: <strong id="totalCount">0</strong></span>
            <span class="muted">Total time watched: <strong id="totalWatched">—</strong></span>
        </div>
    </div>
</section>

<!-- Results -->
<section>
    <div id="histGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5">
        {% for _ in range(8) %}
        <article class="card p-3 animate-pulse">
            <div class="rounded-lg h-40 bg-[color:var(--border)] mb-3"></div>
            <div class="h-4 bg-[color:var(--border)] rounded w-4/5 mb-2"></div>
            <div class="h-3 bg-[color:var(--border)] rounded w-3/5"></div>
        </article>
        {% endfor %}
    </div>

    <!-- Empty -->
    <div id="emptyState" class="hidden text-center muted mt-10">
        <p>No history yet. Start watching a video to see it here.</p>
    </div>

    <!-- Pagination -->
    <div class="mt-8 flex items-center justify-center gap-4">
        <button id="prevBtn" class="btn-ghost px-4 py-2 rounded-lg border border-[color:var(--border)]">⏮ Prev</button>
        <span id="pageNumber" class="text-lg font-medium text-[color:var(--text)]">Page 1</span>
        <button id="nextBtn" class="btn-ghost px-4 py-2 rounded-lg border border-[color:var(--border)]">Next ⏭</button>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/history.js') }}" defer></script>
{% endblock %}