{% extends "layout.html" %}
{% block title %}Category ¬∑ RPC Surgical Video Library{% endblock %}

{% block content %}
<main class="flex gap-6">
    <!-- LEFT PANEL: Categories -->
    <aside class="lg:block w-64 shrink-0">
        <div class="card p-4 sticky top-20">
            <h2 class="text-lg font-bold text-[color:var(--text)] mb-3">üìÇ Categories</h2>
            <ul id="categoryList" class="space-y-1">
                <!-- Filled by category.js:refreshCategories() -->
                <!-- <li>
             <button class="btn-ghost w-full justify-start rounded-lg" data-cat="retina">Retina</button>
           </li> -->
            </ul>
        </div>
    </aside>

    <!-- RIGHT: Category content -->
    <section class="flex-1 min-w-0">
        <!-- Heading -->
        <section class="mb-6">
            <h1 class="text-2xl md:text-3xl font-bold text-[color:var(--text)]">
                üìÇ Category: <span id="categoryName" class="font-extrabold"></span>
            </h1>
            <p class="muted mt-1">Browse all videos under this specialty.</p>
        </section>

        <!-- Toolbar -->
        <section class="mb-6">
            <div class="glass p-3 rounded-xl flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                <!-- Sort -->
                <div class="flex items-center gap-2">
                    <button data-sort="recent"
                        class="sort-btn px-3 py-2 rounded-lg border border-[color:var(--border)] hover:bg-[color:var(--brand-50)]">
                        üÜï Recent
                    </button>
                    <button data-sort="most_viewed"
                        class="sort-btn px-3 py-2 rounded-lg border border-[color:var(--border)] hover:bg-[color:var(--brand-50)]">
                        üëÅÔ∏è Most Viewed
                    </button>
                </div>

                <!-- View toggle -->
                <div>
                    <button id="viewToggle" class="btn-ghost px-3 py-2 rounded-lg border border-[color:var(--border)]"
                        onclick="window.categoryPage?.toggleView?.()">
                        Toggle Grid/List
                    </button>
                </div>
            </div>
        </section>

        <!-- Results -->
        <section>
            <div id="categoryGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5">
                {% for _ in range(8) %}
                <article class="card p-3 animate-pulse">
                    <div class="rounded-lg h-40 bg-[color:var(--border)] mb-3"></div>
                    <div class="h-4 bg-[color:var(--border)] rounded w-4/5 mb-2"></div>
                    <div class="h-3 bg-[color:var(--border)] rounded w-3/5"></div>
                </article>
                {% endfor %}
            </div>

            <!-- Pagination -->
            <div class="mt-8 flex items-center justify-center gap-4">
                <button id="prevBtn" onclick="window.categoryPage?.changePage?.(-1)"
                    class="btn-ghost px-4 py-2 rounded-lg border border-[color:var(--border)]">‚èÆ Prev</button>
                <span id="pageNumber" class="text-lg font-medium text-[color:var(--text)]">Page 1</span>
                <button id="nextBtn" onclick="window.categoryPage?.changePage?.(1)"
                    class="btn-ghost px-4 py-2 rounded-lg border border-[color:var(--border)]">Next ‚è≠</button>
            </div>
        </section>
    </section>
</main>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/category.js') }}"></script>

<!-- Card template -->
<template id="categoryCardTpl">
    <article class="card p-0 overflow-hidden hover:shadow-xl transition-shadow">
        <a class="block relative group" href="#">
            <div class="w-full aspect-video bg-[color:var(--border)] relative overflow-hidden">
                <img class="w-full h-full object-cover block" src="" alt="">
                <span class="absolute bottom-2 right-2 text-xs px-2 py-1 rounded bg-black/70 text-white">00:00</span>
                <span class="absolute top-2 left-2 badge">HD</span>
            </div>
            <div class="p-3">
                <h3 class="font-semibold line-clamp-2 text-[color:var(--text)]"></h3>
                <p class="text-sm mt-1 muted line-clamp-2"></p>
                <div class="flex items-center justify-between mt-3">
                    <div class="flex items-center gap-2">
                        <img class="w-7 h-7 rounded-full" src="" alt="">
                        <span class="text-sm muted"></span>
                    </div>
                    <span class="text-xs muted"></span>
                </div>
            </div>
        </a>
    </article>
</template>

<!-- Row template -->
<template id="categoryRowTpl">
    <a class="card p-3 flex gap-3 hover:shadow-xl transition-shadow items-center" href="#">
        <div class="w-48 shrink-0 aspect-video rounded-lg overflow-hidden bg-[color:var(--border)]">
            <img class="w-full h-full object-cover block" src="" alt="">
        </div>
        <div class="min-w-0 flex-1">
            <h3 class="font-semibold text-[color:var(--text)] line-clamp-1"></h3>
            <p class="text-sm muted mt-1 line-clamp-2"></p>
            <div class="flex items-center gap-2 mt-2">
                <img class="w-6 h-6 rounded-full" src="" alt="">
                <span class="text-xs muted"></span>
                <span class="text-xs">‚Ä¢</span>
                <span class="text-xs muted"></span>
            </div>
        </div>
        <div class="text-xs muted shrink-0 text-right">
            <div class="badge">HD</div>
            <div class="mt-1">00:00</div>
        </div>
    </a>
</template>
{% endblock %}