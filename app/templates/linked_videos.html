{% extends 'layout.html' %}
{% block title %}Linked Videos{% endblock %}
{% block content %}
<section class="mb-8">
  <div class="flex flex-col gap-2 md:flex-row md:items-end md:justify-between">
    <div>
      <h1 class="text-2xl font-bold tracking-tight flex items-center gap-3">
        <span class="bg-gradient-to-r from-[color:var(--brand-600)] to-[color:var(--brand-400)] text-transparent bg-clip-text">Linked Videos</span>
        <span class="hidden text-[10px] uppercase tracking-wider px-2 py-1 rounded-full bg-[color:var(--brand-100)] dark:bg-[color:var(--brand-900)] text-[color:var(--brand-600)] dark:text-[color:var(--brand-300)]">Context</span>
      </h1>
      <p class="muted text-sm mt-1">Videos associated with the selected entity.</p>
    </div>
    <nav class="flex items-center gap-2 text-xs font-medium">
      <a href="/video/admin/link-surgeons" class="px-2 py-1 rounded border border-[color:var(--border)] hover:bg-[color:var(--brand-50)] dark:hover:bg-[color:var(--brand-900)]/40 no-underline" data-requires-role="admin,superadmin">‚Ü© Linking</a>
    </nav>
  </div>
</section>

<div id="contextMeta" class="mb-5 text-sm font-medium flex flex-wrap gap-3"></div>

<div class="glass rounded-2xl shadow-lg border border-[color:var(--border)]/60 overflow-hidden">
  <div class="p-4 border-b border-[color:var(--border)]/60 space-y-3">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
      <div class="flex gap-2 w-full md:w-auto items-center">
        <div class="relative flex-1 md:w-72">
          <input id="videoSearch" placeholder="Search videos by title‚Ä¶" class="input w-full pr-8" />
          <button id="clearSearch" class="absolute inset-y-0 right-0 px-2 text-xs muted hover:text-[color:var(--text)] hidden" type="button">‚úï</button>
        </div>
        <button id="videoSearchBtn" class="btn btn-primary text-sm shrink-0">Search</button>
      </div>
      <div class="flex items-center gap-4 text-[11px]">
        <div class="seg-group" id="pageSizeGroup">
          <button type="button" class="seg" data-size="10">10</button>
          <button type="button" class="seg active" data-size="20" data-active="true">20</button>
          <button type="button" class="seg" data-size="50">50</button>
        </div>
        <div class="flex items-center gap-2">
          <button id="videoPrev" class="btn-ghost px-2 py-1 rounded border border-[color:var(--border)]" title="Previous page">‚èÆ</button>
          <span id="videoPageInfo" class="font-medium tabular-nums"></span>
          <button id="videoNext" class="btn-ghost px-2 py-1 rounded border border-[color:var(--border)]" title="Next page">‚è≠</button>
        </div>
      </div>
    </div>
    <div class="flex items-center justify-between text-[11px] font-medium">
      <span id="videoStats" class="muted"></span>
      <span id="activeQuery" class="muted"></span>
    </div>
  </div>

  <div class="p-4">
    <!-- Spacer to avoid overlap when sticky header engages -->
    <div class="h-0 md:h-0"></div>
    <div id="videoResults" class="mt-2 md:mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5">
      {% for _ in range(8) %}
      <article class="card p-3 animate-pulse">
        <div class="rounded-lg h-40 bg-[color:var(--border)] mb-3"></div>
        <div class="h-4 bg-[color:var(--border)] rounded w-4/5 mb-2"></div>
        <div class="h-3 bg-[color:var(--border)] rounded w-3/5"></div>
      </article>
      {% endfor %}
    </div>
  <div id="videoEmpty" class="hidden py-16 text-center">
      <div class="text-5xl mb-4">üóÇÔ∏è</div>
      <h2 class="text-lg font-semibold mb-2">No linked videos found</h2>
      <p class="muted text-sm max-w-sm">Try adjusting your search or selecting a different page size.</p>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<div id="linkedCtx" data-surgeon-id="{{ surgeon_id|default('', true) }}" data-user-id="{{ user_id|default('', true) }}"></div>
<script src="{{ url_for('static', filename='js/linked_videos.js') }}" defer></script>
{% endblock %}
